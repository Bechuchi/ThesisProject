@using Microsoft.AspNetCore.Mvc.Localization
@model ThesisProject.ViewModels.CourseViewModel
@inject IViewLocalizer Localizer

<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.2.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/jquery.ajax.unobtrusive/3.2.4/jquery.unobtrusive-ajax.min.js"></script>

<h1>@Localizer[Model.Name.ToString()]</h1>

<nav class="progress-nav">
    @foreach (var module in Model.Modules)
    {
        if (module.Status == "TODO")
        {
            <button class="btn btn-danger disabled">@module.Name</button>
        }
        else if (module.Status == "In progress")
        {
            <button class="btn btn-warning active">@module.Name</button>
        }
        else
        {
            <button class="btn btn-success disabled">@module.Name</button>
        }
    }
</nav>

<div id="moduleWrapper" style="overflow: hidden">
    <div id="accordion" style="float: left">
        @foreach (var module in Model.Modules)
        {
            <div class="card">
                <div class="card-header" id="headingOne">
                    <h6 class="mb-0">
                        <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                            @module.Name
                        </button>
                    </h6>
                </div>

                <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
                    <div class="card-body">
                        @foreach (var facts in module.Facts)
                        {
                            <p class="mb-0">
                                <button class="btn btn-link" onclick="openModuleDetails(@facts.Id, 'facts')">
                                    @facts.Name
                                </button>
                            </p>
                        }

                    </div>
                </div>
            </div>
        }
    </div>

    <div id="currentModule">

    </div>
</div>

<script>

    function openModuleDetails(id, type) {

        var element = document.getElementById("currentModule");

        //var content = content;
        var id = id;
        var type = type;
        var sendData = { id: id, type: type}

        $.ajax({
            type: "POST",
            url: "@Url.Action("Details", "Modules")",
            data: sendData,
            success: function (data) {
                 element.innerHTML = data
            },
            traditional: true
        });
    }
</script>